========================================
통합 관제 및 보안 관리 시스템 프로젝트
========================================

【프로젝트 개요】
- 프로젝트명: 통합 관제 및 보안 관리 시스템
- 구성: 서버(WpfApp5) + 클라이언트(WpfApp4)
- 목적: 다중 클라이언트의 브라우저 활동을 실시간으로 모니터링하고 보안 관리
- 개발 환경: .NET 8.0, WPF, C#
- 아키텍처: TCP 서버-클라이언트 모델

【시스템 구조】

┌─────────────────────────────────────┐
│     클라이언트 (WpfApp4)            │
│  - 브라우저 URL 자동 감시           │
│  - Windows Automation API 사용      │
│  - 2초마다 서버로 URL 전송          │
│  - 서버 ALERT 메시지 수신           │
│  - MVVM 패턴 적용                   │
└──────────────┬──────────────────────┘
               │ TCP (포트 5000)
               ▼
┌─────────────────────────────────────┐
│     서버 (WpfApp5)                  │
│  - 다중 클라이언트 동시 처리         │
│  - URL 수신 및 차단 키워드 검사      │
│  - 실시간 웹뷰 표시 (WebView2)      │
│  - 시스템 리소스 모니터링            │
│  - 차단 감지 시 클라이언트에 ALERT   │
└─────────────────────────────────────┘

========================================
【클라이언트 프로젝트 (WpfApp4)】
========================================

【주요 기능】

1. 서버 연결
   - 사용자가 입력한 IP 주소의 5000번 포트로 TCP 연결
   - 연결 성공 시 상태 표시 및 버튼 비활성화
   - MVVM 패턴으로 UI와 로직 분리

2. 브라우저 URL 자동 감시
   - 2초마다 브라우저 주소창을 확인
   - Windows Automation API로 주소창 값을 읽음
   - 한국어/영어 주소창 모두 지원
   - URL이 변경되면 서버로 전송

3. 서버 경고 수신
   - 서버로부터 "ALERT" 포함 메시지 수신 시 경고창 표시
   - 비동기 방식으로 지속적인 메시지 수신

【기술 스택】

- 프레임워크: .NET 8.0-windows
- UI: WPF (Windows Presentation Foundation)
- 네트워크: System.Net.Sockets (TcpClient)
- UI 자동화: System.Windows.Automation
- 디자인 패턴: MVVM (Model-View-ViewModel)

【핵심 코드 설명】

1. MVVM 패턴 구현 (ClientViewModel)
   - INotifyPropertyChanged 인터페이스 구현
   - ServerIp, Status, CanConnect 속성 바인딩
   - UI와 비즈니스 로직 분리

2. 서버 연결 (ConnectToServer)
   - TcpClient로 비동기 연결
   - 연결 성공 시 URL 감시 타이머 및 경고 수신 스레드 시작

3. 브라우저 URL 감시 (GetBrowserUrl)
   - AutomationElement.RootElement로 루트 요소 접근
   - OrCondition으로 한국어/영어 주소창 모두 검색
   - ValuePattern으로 주소창 값 추출

4. 서버 경고 수신 (ListenForServerAlerts)
   - NetworkStream을 통한 지속적인 메시지 수신
   - "ALERT" 포함 메시지 시 MessageBox 표시

【UI 구성】

- 서버 IP 주소 입력 필드 (TextBox)
- 연결 버튼 (Button)
- 상태 표시 레이블 (TextBlock)
- MVVM 바인딩으로 UI 업데이트

========================================
【서버 프로젝트 (WpfApp5)】
========================================

【주요 기능】

1. TCP 서버 운영
   - 포트 5000에서 다중 클라이언트 동시 접속 지원
   - 비동기 방식으로 클라이언트 처리 (HandleClientAsync)
   - 클라이언트 IP 주소 자동 등록 및 관리

2. 실시간 브라우저 모니터링
   - 클라이언트로부터 브라우저 URL 수신
   - WebView2를 통한 실시간 웹페이지 미리보기
   - 선택한 클라이언트의 현재 접속 사이트 표시

3. 보안 차단 시스템
   - 관리자가 설정한 키워드 기반 차단
   - 차단 사이트 접속 시 즉시 경고 메시지 표시
   - 클라이언트에 ALERT 메시지 자동 전송
   - 기본 차단 키워드: youtube.com, facebook.com, twitter.com

4. 시스템 리소스 모니터링
   - CPU 사용률 실시간 표시 (ProgressBar + 그래프)
   - RAM 사용량 모니터링 (WMI로 실제 메모리 용량 자동 감지)
   - 네트워크 속도 표시 (실제 네트워크 인터페이스 카운터 사용)
   - LiveCharts를 활용한 실시간 그래프 (최근 30개 데이터)

5. 사용자 관리
   - 접속 중인 클라이언트 IP 목록 표시
   - 클라이언트 선택 시 해당 사용자의 브라우저 활동 실시간 표시

【기술 스택】

- 프레임워크: .NET 8.0-windows
- UI: WPF (Windows Presentation Foundation)
- 네트워크: System.Net.Sockets (TcpListener, TcpClient)
- 성능 모니터링: System.Diagnostics.PerformanceCounter
- 시스템 정보: System.Management (WMI)
- 차트 라이브러리: LiveCharts.Wpf (v0.9.7)
- 웹뷰: Microsoft.Web.WebView2 (v1.0.3650.58)

【핵심 코드 설명】

1. 서버 시작 (StartServer_Click)
   - TcpListener를 포트 5000에서 시작
   - AcceptTcpClientAsync로 클라이언트 대기
   - 각 클라이언트는 별도 Task로 처리

2. 클라이언트 처리 (HandleClientAsync)
   - 클라이언트 IP 추출 및 등록
   - NetworkStream을 통한 URL 수신
   - 수신한 URL을 소문자로 변환하여 저장
   - 보안 검사 및 웹뷰 업데이트
   - 클라이언트 연결 종료 시 자동 정리

3. 보안 검사 (CheckSecurityAlert)
   - ForbiddenUrlInput의 키워드를 쉼표로 분리
   - 수신한 URL에 차단 키워드 포함 여부 확인
   - 차단 감지 시:
     * 서버에 MessageBox로 경고 표시
     * 클라이언트에 ALERT 메시지 전송

4. 시스템 모니터링 (StartMonitoring)
   - 1초마다 DispatcherTimer로 업데이트
   - PerformanceCounter로 CPU/RAM 정보 수집
   - 실제 네트워크 인터페이스의 Bytes Total/sec 측정
   - LiveCharts에 데이터 추가 (최대 30개)

5. 메모리 용량 자동 감지 (GetTotalMemory)
   - WMI(Windows Management Instrumentation) 사용
   - Win32_ComputerSystem에서 TotalPhysicalMemory 조회
   - 실제 하드웨어 메모리 용량을 GB 단위로 계산

6. 네트워크 모니터링 개선
   - Network Interface 카운터로 실제 네트워크 인터페이스 감지
   - 모든 네트워크 인터페이스의 Bytes Total/sec 합산
   - Bytes/sec를 Mbps로 변환 (×8 / 1024²)

7. 웹뷰 업데이트 (UpdateWebView)
   - 선택된 클라이언트의 URL을 WebView2에 표시
   - http/https 프로토콜 자동 추가

【UI 구성】

- 상단: 서버 가동 버튼 및 상태 표시
- 왼쪽 패널: 시스템 리소스 모니터링 (CPU, RAM, 네트워크, 그래프)
- 중간 패널: 접속 중인 클라이언트 목록
- 오른쪽 패널: 선택한 클라이언트의 실시간 웹뷰
- 하단: 보안 차단 키워드 설정

========================================
【통신 프로토콜】
========================================

【클라이언트 → 서버】
- 전송 데이터: 브라우저 URL (UTF-8 인코딩)
- 전송 시점: URL 변경 감지 시 (2초마다 체크)
- 중복 방지: 마지막으로 보낸 URL과 다를 때만 전송

【서버 → 클라이언트】
- 전송 데이터: "ALERT: [키워드] 접속이 감지되었습니다. 즉시 종료하세요!"
- 전송 시점: 차단 사이트 접속 감지 시
- 수신 처리: 클라이언트에서 ALERT 포함 메시지 시 경고창 표시

========================================
【주요 특징】
========================================

✓ 다중 클라이언트 동시 처리 (비동기)
✓ 실시간 모니터링 (서버: 1초 간격, 클라이언트: 2초 간격)
✓ 시각적 데이터 표현 (ProgressBar, 그래프)
✓ 사용자 친화적 UI (현대적인 디자인)
✓ 확장 가능한 차단 키워드 시스템
✓ 실제 하드웨어 정보 활용 (WMI)
✓ 실제 네트워크 트래픽 측정
✓ MVVM 패턴 적용 (클라이언트)
✓ 양방향 통신 (서버 ↔ 클라이언트)

========================================
【개선 사항 및 향후 계획】
========================================

【이미 구현된 개선 사항】
✓ 서버 → 클라이언트 ALERT 메시지 전송 기능 구현
✓ 실제 메모리 용량 자동 감지 (WMI)
✓ 실제 네트워크 트래픽 측정
✓ MVVM 패턴 적용 (클라이언트)

【추가 개선 가능한 부분】
- 차단 사이트 접속 시 자동 차단 기능 (브라우저 종료 등)
- 접속 로그 저장 기능 (파일 또는 데이터베이스)
- 관리자 인증 시스템
- 데이터베이스 연동 (접속 이력 저장)
- 웹 대시보드 구축
- 다중 서버 지원 (로드 밸런싱)
- 암호화 통신 (TLS/SSL)
- 사용자별 차단 정책 설정

========================================
